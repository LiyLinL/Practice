/*

@license
dhtmlxScheduler v.5.3.10 Professional

This software is covered by DHTMLX Commercial License. Usage without proper license is prohibited.

(c) XB Software Ltd.

*/
Scheduler.plugin(function(e){(function(){e._grid={names:{},sort_rules:{int:function(e,t,r){return r(e)*1<r(t)*1?1:-1},str:function(e,t,r){return r(e)<r(t)?1:-1},date:function(e,t,r){return new Date(r(e))<new Date(r(t))?1:-1}},_getObjName:function(e){return"grid_"+e},_getViewName:function(e){return e.replace(/^grid_/,"")}}})();e.createGridView=function(t){var r=t.name||"grid";var i=e._grid._getObjName(r);e._grid.names[r]=r;e.config[r+"_start"]=t.from||new Date(0);e.config[r+"_end"]=t.to||new Date(9999,1,1);e[i]=t;e[i].defPadding=8;e[i].columns=e[i].fields;e[i].unit=t.unit||"month";e[i].step=t.step||1;delete e[i].fields;function a(e){return!(e!==undefined&&(e*1!=e||e<0))}var d=e[i].columns;for(var _=0;_<d.length;_++){if(a(d[_].width))d[_].initialWidth=d[_].width;if(!a(d[_].paddingLeft))delete d[_].paddingLeft;if(!a(d[_].paddingRight))delete d[_].paddingRight}e[i].select=t.select===undefined?true:t.select;if(e.locale.labels[r+"_tab"]===undefined)e.locale.labels[r+"_tab"]=e[i].label||e.locale.labels.grid_tab;e[i]._selected_divs=[];e.date[r+"_start"]=function(r){if(e.date[t.unit+"_start"])return e.date[t.unit+"_start"](r);else return r};e.date["add_"+r]=function(t,r){return e.date.add(t,r*e[i].step,e[i].unit)};e.templates[r+"_date"]=function(t,r){if(e.config.rtl){return e.templates.day_date(r)+" - "+e.templates.day_date(t)}else{return e.templates.day_date(t)+" - "+e.templates.day_date(r)}};e.templates[r+"_full_date"]=function(t,i,a){if(e.isOneDayEvent(a)){return this[r+"_single_date"](t)}else if(e.config.rtl){return e.templates.day_date(i)+" &ndash; "+e.templates.day_date(t)}else{return e.templates.day_date(t)+" &ndash; "+e.templates.day_date(i)}};e.templates[r+"_single_date"]=function(t){return e.templates.day_date(t)+" "+this.event_date(t)};e.templates[r+"_field"]=function(e,t){return t[e]};e.attachEvent("onTemplatesReady",function(){e.attachEvent("onEventSelected",function(t){if(this._mode==r&&e[i].select){e._grid.selectEvent(t,r);return false}});e.attachEvent("onEventUnselected",function(t){if(this._mode==r&&e[i].select){e._grid.unselectEvent("",r)}});var t=e.render_data;e.render_data=function(a){if(this._mode==r)e._grid._fill_grid_tab(i);else return t.apply(this,arguments)};var a=e.render_view_data;e.render_view_data=function(){var t=e._els["dhx_cal_data"][0].lastChild;if(this._mode==r&&t){e._grid._gridScrollTop=t.scrollTop}return a.apply(this,arguments)}});e[r+"_view"]=function(t){e._grid._sort_marker=null;delete e._gridView;e._grid._gridScrollTop=0;e._rendered=[];e[i]._selected_divs=[];if(t){var a=null,d=null;var _=e[i];if(_.paging){a=e.date[r+"_start"](new Date(e._date));d=e.date["add_"+r](a,1)}else{a=e.config[r+"_start"];d=e.config[r+"_end"]}e._min_date=a;e._max_date=d;e._grid.set_full_view(i);var n="";if(+a>+new Date(0)&&+d<+new Date(9999,1,1)){n=e.templates[r+"_date"](a,d)}var l=e._getNavDateElement();if(l){l.innerHTML=n}e._gridView=i}else{}}};e.dblclick_dhx_grid_area=function(){if(!this.config.readonly&&this.config.dblclick_create)this.addEventNow()};if(e._click.dhx_cal_header){e._old_header_click=e._click.dhx_cal_header}e._click.dhx_cal_header=function(t){if(e._gridView){var r=t||window.event;var i=e._grid._get_target_column(r,e._gridView);e._grid._toggle_sort_state(e._gridView,i.id);e.clear_view();e._grid._fill_grid_tab(e._gridView)}else if(e._old_header_click)return e._old_header_click.apply(this,arguments)};e._grid.selectEvent=function(t,r){if(e.callEvent("onBeforeRowSelect",[t])){var i=e._grid._getObjName(r);e.for_rendered(t,function(t){t.className+=" dhx_grid_event_selected";e[i]._selected_divs.push(t)})}};e._grid._unselectDiv=function(e){e.className=e.className.replace(/ dhx_grid_event_selected/,"")};e._grid.unselectEvent=function(t,r){var i=e._grid._getObjName(r);if(!i||!e[i]._selected_divs)return;if(!t){for(var a=0;a<e[i]._selected_divs.length;a++)e._grid._unselectDiv(e[i]._selected_divs[a]);e[i]._selected_divs=[]}else{for(var a=0;a<e[i]._selected_divs.length;a++)if(e[i]._selected_divs[a].getAttribute("event_id")==t){e._grid._unselectDiv(e[i]._selected_divs[a]);e[i]._selected_divs.slice(a,1);break}}};e._grid._get_target_column=function(t,r){var i=t.originalTarget||t.srcElement;var a=e._getClassName(i);if(a=="dhx_grid_view_sort")i=i.parentNode;var d=0;for(var _=0;_<i.parentNode.childNodes.length;_++){if(i.parentNode.childNodes[_]==i){d=_;break}}return e[r].columns[d]};e._grid._get_sort_state=function(t){var r=e[t];return r.sort};e._grid._toggle_sort_state=function(t,r){var i=this._get_sort_state(t);var a=e[t];if(i&&i.column==r){i.direction=i.direction=="asc"?"desc":"asc"}else{a.sort={column:r,direction:"desc"}}};e._grid._get_sort_value_for_column=function(e){var t=null;if(e.template){var r=e.template;t=function(e){return r(e.start_date,e.end_date,e)}}else{var i=e.id;if(i=="date")i="start_date";t=function(e){return e[i]}}return t};e._grid.draw_sort_marker=function(t,r){if(e._grid._sort_marker){e._grid._sort_marker.className=e._grid._sort_marker.className.replace(/( )?dhx_grid_sort_(asc|desc)/,"");e._grid._sort_marker.removeChild(e._grid._sort_marker.lastChild)}if(r){var i=e._grid._get_column_node(t,r.column);i.className+=" dhx_grid_sort_"+r.direction;e._grid._sort_marker=i;var a="<div class='dhx_grid_view_sort' style='left:"+(+i.style.width.replace("px","")-15+i.offsetLeft)+"px'>&nbsp;</div>";i.innerHTML+=a}};e._grid.sort_grid=function(t){t=t||{direction:"desc",value:function(e){return e.start_date},rule:e._grid.sort_rules["date"]};var r=e.get_visible_events();r.sort(function(e,r){return t.rule(e,r,t.value)});if(t.direction=="asc"){r=r.reverse()}return r};e._grid.set_full_view=function(t){if(t){var r=e.locale.labels;var i=e._grid._print_grid_header(t);e._els["dhx_cal_header"][0].innerHTML=i;e._table_view=true;e.set_sizes()}};e._grid._calcPadding=function(t,r){return(t.paddingLeft!==undefined?1*t.paddingLeft:e[r].defPadding)+(t.paddingRight!==undefined?1*t.paddingRight:e[r].defPadding)};e._grid._getStyles=function(e,t){var r=[],i="";for(var a=0;t[a];a++){i=t[a]+":";switch(t[a]){case"text-align":if(e.align)r.push(i+e.align);break;case"vertical-align":if(e.valign)r.push(i+e.valign);break;case"padding-left":if(e.paddingLeft!==undefined)r.push(i+(e.paddingLeft||"0")+"px");break;case"padding-right":if(e.paddingRight!==undefined)r.push(i+(e.paddingRight||"0")+"px");break}}return r};e._grid._get_column_node=function(t,r){var i=-1;for(var a=0;a<t.length;a++){if(t[a].id==r){i=a;break}}if(i<0)return null;return e._obj.querySelectorAll(".dhx_grid_line > div")[i]};e._grid._get_sort_rule=function(t){var r=e[t];var i=this._get_sort_state(t);var a;if(i){var d;for(var _=0;_<r.columns.length;_++){if(r.columns[_].id==i.column){d=r.columns[_];break}}if(d){var n=e._grid._get_sort_value_for_column(d);var l=d.sort;if(typeof l!="function"){l=e._grid.sort_rules[l]||e._grid.sort_rules["str"]}a={direction:i.direction,rule:l,value:n}}}return a};e._grid._fill_grid_tab=function(t){var r=e[t];var i=this._get_sort_state(t);var a=this._get_sort_rule(t);if(a){e._grid.draw_sort_marker(r.columns,i)}var d=e._date;var _=e._grid.sort_grid(a);var n=e[t].columns;var l="<div>";var s=-2;for(var g=0;g<n.length;g++){var o=e._grid._calcPadding(n[g],t);s+=n[g].width+o;if(g<n.length-1){var c=e.config.rtl?"right":"left";l+="<div class='dhx_grid_v_border' style='"+c+":"+s+"px'></div>"}}l+="</div>";var f=e._waiAria.gridAttrString();l+="<div class='dhx_grid_area'><table "+f+">";for(var g=0;g<_.length;g++){l+=e._grid._print_event_row(_[g],t)}l+="</table></div>";e._els["dhx_cal_data"][0].innerHTML=l;e._els["dhx_cal_data"][0].lastChild.scrollTop=e._grid._gridScrollTop||0;var u=e._els["dhx_cal_data"][0].getElementsByTagName("tr");e._rendered=[];for(var g=0;g<u.length;g++){e._rendered[g]=u[g]}};e._grid._getCellContent=function(t,r){var i;var a=e.getState().mode;if(r.template){i=r.template(t.start_date,t.end_date,t)}else if(r.id=="date"){i=e.templates[a+"_full_date"](t.start_date,t.end_date,t)}else if(r.id=="start_date"||r.id=="end_date"){i=e.templates[a+"_single_date"](t[r.id])}else{i=e.templates[a+"_field"](r.id,t)}return i};e._grid._print_event_row=function(t,r){var i=[];if(t.color)i.push("background:"+t.color);if(t.textColor)i.push("color:"+t.textColor);if(t._text_style)i.push(t._text_style);if(e[r]["rowHeight"])i.push("height:"+e[r]["rowHeight"]+"px");var a="";if(i.length){a="style='"+i.join(";")+"'"}var d=e[r].columns;var _=e.templates.event_class(t.start_date,t.end_date,t);var n=e._waiAria.gridRowAttrString(t);var l="<tr "+n+" class='dhx_grid_event"+(_?" "+_:"")+"' event_id='"+t.id+"' "+a+">";var s=e._grid._getViewName(r);var g=["text-align","vertical-align","padding-left","padding-right"];for(var o=0;o<d.length;o++){var c=e._grid._getCellContent(t,d[o]);var f=e._waiAria.gridCellAttrString(t,d[o],c);var u=e._grid._getStyles(d[o],g);var v=d[o].css?' class="'+d[o].css+'"':"";l+="<td "+f+" style='width:"+d[o].width+"px;"+u.join(";")+"' "+v+">"+c+"</td>"}l+="<td class='dhx_grid_dummy'></td></tr>";return l};e._grid._print_grid_header=function(t){var r="<div class='dhx_grid_line'>";var i=e[t].columns;var a=[];var d=i.length;var _=e._obj.clientWidth-2*i.length-20;for(var n=0;n<i.length;n++){var l=i[n].initialWidth*1;if(!isNaN(l)&&i[n].initialWidth!==""&&i[n].initialWidth!==null&&typeof i[n].initialWidth!="boolean"){d--;_-=l;a[n]=l}else{a[n]=null}}var s=Math.floor(_/d);var g=["text-align","padding-left","padding-right"];for(var o=0;o<i.length;o++){var c=!a[o]?s:a[o];i[o].width=c-e._grid._calcPadding(i[o],t);var f=e._grid._getStyles(i[o],g);r+="<div style='width:"+(i[o].width-1)+"px;"+f.join(";")+"'>"+(i[o].label===undefined?i[o].id:i[o].label)+"</div>"}r+="</div>";return r}});